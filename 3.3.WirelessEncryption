---

DAY 3: WIRELESS PENTESTING (WiFi Encryption PART3) 26/1/2023
[+] WPA3 (Wi-Fi Protected Access version 3)
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
is the latest version of the Wi-Fi security protocol that was created by the Wi-Fi Alliance,
Similarities with WPA2:
Both uses the Advanced Encryption Standard (AES) algorithm to encrypt data transmitted over a wireless network.
Both uses a Temporal Key Integrity Protocol (TKIP) to ensure the integrity of the encryption keys used to protect data transmitted over the network.

Improvements from WPA2
Improved encryption: WPA3 uses the Advanced Encryption Standard (AES) in Galois/Counter Mode (GCM) for encryption, which is considered to be more secure than the Temporal Key Integrity Protocol (TKIP) used in WPA2.
Simultaneous Authentication of Equals (SAE): WPA3 uses SAE, a password-based authentication method, to provide stronger protection against offline dictionary attacks. It uses a technique called "password-authenticated key agreement" (PAKE) to establish a shared secret between the client device and the access point (AP) without revealing the password.
Opportunistic Wireless Encryption (OWE): WPA3 includes OWE, which allows for the automatic encryption of wireless network traffic even when a device is not authenticated.
Protected Management Frames" (PMF):Protected Management Frames (PMF) is a feature in WPA3 that provides protection for management frames(Management frames are a type of frame in the IEEE 802.11 wireless networking protocol that are used to control and manage wireless networks. They are used for a variety of tasks, such as authentication, association, and power management.), which are used to control and manage wireless networks. PMF provides protection against rogue access points and other attacks that aim to disrupt or take control of wireless networks.
Improved protection against brute-force attacks: WPA3 includes features that make it more difficult for an attacker to perform brute-force attacks, such as limiting the number of attempts to enter a password and increasing the time between attempts.

WPA3 Authentication:
WPA3 uses EAP for certificate-based or username/password-based authentication and SAE for password-based authentication to provide stronger protection against offline dictionary attacks
Simultaneous Authentication of Equals (SAE), also known as "Dragonfly". SAE is a password-based authentication method that is designed to provide stronger protection against offline dictionary attacks, which are a common type of attack used to crack Wi-Fi passwords.
The steps of the Simultaneous Authentication of Equals (SAE) process used in WPA3 can be illustrated with a real-life example of a device (such as a smartphone) connecting to a wireless network:
Device and Access Point (AP) exchange "commit" messages: The device and AP exchange a series of "commit" messages, which are used to prove that the device and AP have the same password without actually revealing the password. For example, the device sends a commit message to the AP that includes a random number and a cryptographic value derived from the password.
Device and AP generate a shared secret: The device and AP use the commit messages and a password-authenticated key agreement (PAKE) algorithm to generate a unique shared secret. For example, the AP uses the cryptographic value and the random number from the device's commit message, along with its own copy of the password, to derive a shared secret.
Device and AP exchange "confirm" messages: The device and AP exchange "confirm" messages to ensure that the shared secret was generated correctly. For example, the AP sends a confirm message to the device that includes a cryptographic value derived from the shared secret, and the device verifies that the value matches the one it generated.
Device and AP derive a pairwise transient key (PTK): The device and AP use the shared secret to derive a pairwise transient key (PTK), which is used to encrypt data transmitted over the wireless network.
Device and AP exchange "authentication complete" message: Once the PTK has been derived, the device and AP exchange an "authentication complete" message to indicate that the authentication process is finished, and the device is granted access to the network.
Device and AP use the PTK for encryption: The device and AP use the derived PTK for encrypting the data transmitted over the wireless network.

Protected Management Frames (PMF):
PMF works by encrypting management frames and providing integrity protection for them. This ensures that only authorized devices can access and modify the management frames. PMF requires that both the client device and the access point support PMF, and that the network is configured to use PMF.
Examples of management frames include:
Beacon frames: sent by access points to announce their presence and provide information about the network
Association Request/Response frames: used to establish a connection between a client device and an access point
Probe Request/Response frames: used by client devices to discover available networks and by access points to respond to probe requests
Authentication frames: used to authenticate client devices before they are allowed to connect to the network
Deauthentication and Disassociation frames: used to disconnect client devices from the network

The steps for Protected Management Frames (PMF) in WPA3 are as follows:
Both the client device and the access point must support PMF. This means that the client device must have a wireless adapter that supports PMF, and the access point must be configured to support PMF.
The client device sends a Probe Request frame to the access point, indicating that it supports PMF.
The access point sends a Probe Response frame back to the client device, indicating that it also supports PMF.
The client device sends an Association Request frame to the access point, requesting to join the network.
The access point sends an Association Response frame to the client device, indicating that the association request has been accepted.
The client device and the access point exchange Authentication frames to authenticate each other.
The client device and the access point establish a pairwise master key (PMK) which is used to encrypt and decrypt management frames.
The client device and the access point exchange management frames that are encrypted and integrity protected using the PMK
The client device and the access point continue to exchange management frames in a protected manner for the duration of the association

[+] Opportunistic Wireless Encryption (OWE):
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Opportunistic Wireless Encryption (OWE) is a feature in WPA3 that provides encryption for open wireless networks without requiring a password or other credentials. It is designed to be easy to use and provide a higher level of security for open wireless networks, such as those found in public places like coffee shops, airports, and hotels.
Opportunistic Wireless Encryption (OWE) is a feature in WPA3 that provides encryption for open wireless networks without requiring a password or other credentials. It is designed to be easy to use and provide a higher level of security for open wireless networks, such as those found in public places like coffee shops, airports, and hotels.
Here are the basic steps of how OWE works in WPA3:
The client device scans for available wireless networks and sees an open network that supports OWE.
The client device sends a request to the access point (AP) to establish an OWE connection.
The AP generates a unique Diffie-Hellman (DH) public key and sends it to the client device.
The client device generates its own DH public key and sends it to the AP.
The AP and client device use their respective DH public keys to generate a shared secret key, which is used to encrypt the wireless traffic between them.
Once the connection is established, all wireless traffic between the client device and the AP is encrypted, providing a higher level of security for the open wireless network.

OWE can be used alongside other authentication methods such as SAE to further improve the security of the network, and it is designed to be backwards compatible with devices that support WPA2.
Another encryption feature that WPA3 uses is the "Protected Management Frames" (PMF) which ensures that the management frames are encrypted so that they cannot be intercepted or tampered with.
In summary, WPA3 uses SAE authentication, a password-based authentication method to provide stronger protection against offline dictionary attacks, and it also uses AES encryption and PMF to encrypt data transmitted over the wireless network to protect it from unauthorized access.

---

WPA3 Home vs Enterprise:
WPA3 is available in two different versions: WPA3-Personal and WPA3-Enterprise.
WPA3-Personal is intended for home and small office use, it is designed to be easy to set up and use, and it uses a password-based authentication method called Simultaneous Authentication of Equals (SAE) to provide stronger protection against offline dictionary attacks.
WPA3-Enterprise is intended for enterprise and business use, it provides more robust security features and more advanced authentication methods for large organizations. It also uses the Extensible Authentication Protocol (EAP) for authentication, which allows for the use of various authentication methods such as EAP-TLS, EAP-TTLS, EAP-PEAP, and EAP-FAST.
One of the major differentiators between the two versions is the level of security they provide. WPA3-Enterprise is considered more secure than WPA3-Personal because it offers advanced features such as support for digital certificates and more advanced authentication methods. Additionally, WPA3-Enterprise is designed to be more scalable and can support multiple access points and thousands of clients.
WPA3-Personal is considered more suited for home and small office use, with the primary aim of providing better security than WPA2-Personal, while WPA3-Enterprise is intended to be used in business and enterprise environments, to provide better security and more advanced features than WPA2-Enterprise.

---

[+] Wireless Protected Setup (WPS)
- - - - - - - - - - - - - - - - - - - - - - - - - - -
Wi-Fi Protected Setup (WPS) is a feature in wireless routers and other devices that allows for easy setup and configuration of wireless networks. It is designed to make it easy for users to connect to a wireless network without having to manually enter a password or other credentials.
The WPS feature uses two methods to connect to a wireless network:
Push-Button Connect (PBC): This method allows users to simply press a button on the wireless router to connect to the network. When the button is pressed, the router sends a signal to the client device, and the client device automatically connects to the network using a pre-configured password.

The user initiates the PBC process by pressing a button on the wireless router or access point. The button is typically labeled "WPS" or "PBC".
The wireless router sends a signal to all nearby devices, announcing that it is ready to connect to a new device using PBC
The client device, such as a laptop or smartphone, receives the signal and prompts the user to initiate the PBC process.
The user confirms the connection on the client device, and the client device sends a connection request to the wireless router.
The wireless router authenticates the client device by checking that the device is in proximity and by comparing the device's MAC address to a pre-configured list of allowed devices.
Once the client device is authenticated, the wireless router sends the pre-configured wireless network password to the client device.
The client device uses the password to connect to the wireless network.

2. Personal Identification Number (PIN) Connect: This method allows users to enter a PIN code on the client device to connect to the network. The PIN code is typically located on a sticker on the bottom of the wireless router. When the PIN code is entered on the client device, the router sends a signal to the client device, and the client device automatically connects to the network using a pre-configured password.
The user initiates the PIN process by entering a unique PIN code on the client device. The PIN code is typically located on a sticker on the bottom of the wireless router or access point.
The client device sends the entered PIN code to the wireless router or access point.
The wireless router or access point authenticates the client device by comparing the entered PIN code to the PIN code that is stored on the device or generated by the device.
Once the client device is authenticated, the wireless router or access point sends the pre-configured wireless network password to the client device.
The client device uses the password to connect to the wireless network.

WPS is intended to be a convenient way for users to set up and connect to wireless networks, but it has been found to have security vulnerabilities, such as brute-force attacks, which can be exploited by attackers to gain access to a wireless network. Due to this reason, many security experts recommend disabling WPS on wireless routers and using other more secure methods to connect to wireless networks.
